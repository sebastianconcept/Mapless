---
layout: default
title: Mapless, obscenely simple object persistence
---


<div class="container">
    <div class="header">
        <div class="row">
            <div class="logoWrap">
                <div class="symbol">
                    <img alt="Mapless logo" src="images/symbol.png">
                </div>    
                <div class="center-on-mobiles">
                    <h1>Mapless</h1>
                </div>
                <p class="descriptive-tagline">Schema-less persistence for Smalltalk with support for multiple backends.</p>
        </div>
        </div>    
    </div>

    <div class="content">
        <section class="intro">
          {% include intro.html %}
        </section>
        <section class="start">
                <div class="col-md-4 loadNow center-on-mobiles">
                    <h4>Saving Smalltalk objects <em>in seconds</em></h4>
                </div>
                <div class="col-md-8 ">
                    <div class="quickstart">
                        <p class="shellTitle">Load in Pharo</p>
                        {% include baselineOfMapless.html %}
                    </div>
                </div>            
        </section>

        <section class="howDoesItFeel">
                <div class="col-md-5 ">
                    <div class="elaborate">
                        <h5>Need to persist modeled data?</h5>
                        <p>This is what happens when you do it with Mapless:</p>
                        <ol>
                            <li>Create a dedicated subclass for each type of data model.</li>
                            <li><del>Know in advance the attributes they'll require.</del></li>
                            <li><del>Create instance variables for these attributes.</del></li>
                            <li><del>Add accessors for each of them.</del></li>
                            <li><del>Careful map them so it all fits in the database.</del></li>
                            <li><del>Patiently re-map them every time you need to change its design saying 'hi' to object-database mismatches.</del></li>
                            <li>Actually save them.</li>
                            <li>Profit.</li>
                        </ol>
                    </div>
                </div>

                 <!-- <div id="screencast" class="col-md-7">
                    <div class="elaborate ">
                        <h5 >Screencast</h5>
                        <p><iframe width="420" height="315" src="//www.youtube.com/embed/BNXXDOPLxtE" frameborder="0" allowfullscreen></iframe></p>
                    </div>
                </div> -->

                <div class="col-md-12">
                    <div class="elaborate">
                        <h5>How does it look like?</h5>
                        <p>Let's say you want to store and retrieve instances of <code>Task</code> as Mapless models using MongoDB as backend.</p>
                        <p>In essence, you'll create a repository object to handle <code>Task</code> instances — saving, querying, updating, or deleting them.</p>
                        <p>Let's see the snippets for achieving these basic operations one by one.</p>
                    </div>
                </div>

                <div class="col-md-12">
                    <div class="elaborate">
                        <h5>Create the repository</h5>
                        <p>There are two ways to access MongoDB with Mapless. <code>MaplessStandaloneMongoPool</code> for single server setups and <code>MaplessMongoReplicaSetPool</code> for clusters of <a href="https://www.mongodb.com/docs/manual/replication/" target="_blank"> replica sets</a>.</p>
                        <p>The following one shows an example for accessing a local standalone MongoDB.</p>
                    </div>
                </div>

                <div class="col-md-9 workspace">
                    <div class="">
                        <p class="shellTitle">Create a repository to access a standalone MongoDB service</p>
                        {% include repository.html %}
                    </div>
                </div> 

                <div class="col-md-12">
                    <div class="elaborate extraTop">
                        <h5>Model your data</h5>
                        <p>Creating new instances of your data models is straightforward — treat them like any other object.</p>
                        <p>The only thing to remark here is that you do not need to create the mutator methods <code>description:</code> nor <code>isComplete:</code> in the <code>Task</code> class.</p>
                    </div>
                </div>                

                <div class="col-md-9 workspace">
                    <div class="">
                        <p class="shellTitle">Create a new model</p>
                        {% include model.html %}
                    </div>
                </div>                 

                <div class="col-md-12">
                    <div class="elaborate extraTop">
                        <h5>Storing</h5>
                        <p>To store data, simply send the <code>save</code> message to any <code>Mapless</code> instance, and be automatically inserted or updated in the database.</p>
                        <p>The repository object features the <code>do:</code> method, accepting a block closure. This allows your Mapless object to understand the repository it should work with.</p>
                        <p>Alternatively, you can implement <code>Task class>>getRepository</code> to have the model provide the repository directly, enabling it to handle the  <code>save</code> operation without relying on a closure from external sources.</p>
                    </div>
                </div>

                <div class="col-md-9 workspace">
                    <div class="">
                        <p class="shellTitle">Saving a model</p>
                        {% include save.html %}
                    </div>
                </div> 

                 <div class="col-md-12 ">
                    <div class="elaborate extraTop">
                        <h5 id="getting">Querying</h5>
                        <p>Mapless supports various persistent backends, and the method of implementing queries for your data depends on the specific backend in use. For instance, with a PostgreSQL or SQLite backend, SQL queries are employed. In the case of MongoDB, Mapless utilizes the <a href="http://smalltalkhub.com/#!/~MongoTalkTeam/mongotalk">MongoTalk</a> querying feature, while Redis adopts a namespaced convention.</p>
                    </div>
                </div>

                <div class="col-md-9 workspace">
                    <div class="">
                        <p class="shellTitle">Fetching objects</p>
                        {% include findAll.html %}
                    </div>
                </div> 

                 <div class="col-md-12 ">
                    <div class="elaborate extraTop">
                        <h5 id="adding">Making the queries powerful</h5>
                        <p>Let's say you are using a MongoDB backend and want a production ready query by <code>username</code> for this <code>Task</code>. All you have to do is to <a href="https://www.mongodb.com/docs/manual/reference/method/db.collection.createIndex/" target="_blank">create an index in MongoDB</a> for <code>username</code> in the <code>Task</code> collection. Optionally, you can add a class method in <code>Task</code> tailored to this query.</p>
                    </div>
                </div>

                <div class="col-md-9 workspace">
                    <div class="">
                        <p class="shellTitle">Querying efficiently</p>
                        {% include findAtUsername.html %}
                    </div>
                </div> 

                 <div class="col-md-12 ">
                    <div class="elaborate extraTop">
                        <h5 id="updating">Adding properties to models</h5>
                        <p>Simply do it. Unless overriden, Mapless catches all messages you send to a model via <a href="https://wiki.c2.com/?DoesNotUnderstand" target="_blank">DNU</a>. It is smart enough to allow you to add a date a string or almost any other object without declaring instVars or demanding making schemas or any accessors for it.</p>
                    </div>
                </div>

                <div id="simple" class="col-md-9 workspace">
                    <div class="">
                        <p class="shellTitle">Adding information to your data</p>
                        {% include update.html %}
                    </div>
               </div> 

                 <div id="composability" class="col-md-12 ">
                    <div class="elaborate">
                        <h5 id="adding">Composition</h5>
                        <p>When you model data using your custom Mapless classes, you have the flexibility to add almost any property to them, especially other Mapless models—hence, composition. In such cases, Mapless efficiently organizes the data, utilizing one collection or table in the backend per type of Mapless object.</p>
                        <p>The main rule when working with composition here is <em>save the children first</em>.</p>
                    </div>
                </div>


                <div  class="col-md-9 workspace">
                    <div class="">
                        <p class="shellTitle">Composing models</p>
                        {% include composition.html %}
                    </div>
                </div> 

                <div class="col-md-12 ">
                    <div class="elaborate extraTop">
                        <h5 id="adding">Graph navigation</h5>
                        <p>Saving a Mapless object is akin to planting the root of a graph. When interacting with a composed Mapless object, accessing the child Mapless feels like navigating one level deeper in the object graph. Composed Mapless objects return lazy references for every known (sub)Mapless to the parent. When you send a message to a (sub)model, the DNU method seamlessly resolves it, making it appear as if it was always there.</p>
                        <p>At the same time, if a Mapless object never sends any message to a child, then your application is not doing any unnecessary query. This prevents your backend from doing unnecessary extra work in advance making your system more efficient by default and in general.</p>
                    </div>
                </div>

                <div class="col-md-9 workspace">
                    <div class="">
                        <p class="shellTitle">Navigating model graphs</p>
                        {% include navigation.html %}
                    </div>
                </div> 

                <div class="col-md-12 ">
                    <div class="elaborate extraTop">
                        <h5 id="portability">Supported backends</h5>
                        <p>All Mapless subclasses share the same fundamental Smalltalk API. When resolving requested operations, they delegate to a corresponding <code>MaplessRepository</code> subclass aligned with one of the concrete supported backends.</p>
                        <p>Currently supported backends include:</p>
                        <ol>
                            <li>SQLite.</li>
                            <li>PostgreSQL.</li>
                            <li>MongoDB.</li>
                            <li>Redis.</li>
                            <li>Memory.</li>
                            <li><s>UnQLite</s> (Deprecated and retiring soon).</li>
                        </ol>
                    </div>
                </div>

                 <div id="why" class="col-md-12 ">
                    {% include intention.html %}
                </div>

                <div class="col-md-12 ">
                    <div class="elaborate extraTop">
                        <h5>Applicability and Case Studies</h5>
                        <p>Mapless has been in production since 2014 and exposed to a variety of scenarios. From Proof of Concepts to mission critical services monitored 24/7 by a dozens of network operators in the telecom industry.</p>
                        <p>Mapless has been and is in use for:</p>
                        <ul>
                            <li>Proof of Concept APIs.</li>
                            <li><a href="https://bff-patterns.com/" target="_blank">BBFs</a> - Backend For Frontends.</li>
                            <li>Persistence solution to develop <a href="https://en.wikipedia.org/wiki/Minimum_viable_product" target="_blank">MVPs</a> at minimal cost and fastest speeds.</li>
                            <li>RESTful custom APIs.</li>
                            <li>CRM integration for the hospitality industry in Austria.</li>
                            <li>Scaling APIs to thousands of operations per second for years in the Telecommunications industry.</li>
                        </ul>
                    </div>
                </div>

                <div class="col-md-12 ">
                    <div class="elaborate extraTop">
                        <h5>Guides</h5>
                        <p>Here are some guides we're working on:</p>
                        <ul>
                            <li>RESTful APIs with Mapless on Teapot.</li>
                            <li>Redis as a cache.</li>
                            <li>Redis as messaging channel across images.</li>
                            <li>Using Maples with a MongoDB Replica Set.</li>
                            <li>Simple Web Application PoC with htmx Teapot and Mapless.</li>
                        </ul>
                    </div>
                </div>

                 <div id="involved" class="col-md-12 ">
                    <div class="elaborate">
                        <h5 class="">Frequently Asked Questions</h5>
                            <p><em>What saving 'Models' means? why not any object?</em></p>
                            <p>By "Models," Mapless refers to instances that represent persistent data, excluding transient entities such as contexts, sockets, or file handlers. Any instance of a Mapless subclass can be saved effortlessly. These instances are serialized and stored as documents in their respective MongoDB collection or PostgreSQL table.</p>
                            <p><em>Is only for tree-like structures or does actually support an object graph?</em></p>
                            <p>As long as you adhere to its rules, such as saving children first and treating your models as NoSQL-friendly documents and not trying to store a Socket or some unserializable object, yes, Mapless does support an arbitrary object graph.</p>
                            <p><em>Why would I want to use Mapless?</em></p>
                            <p> Because you might want to profit from some of these benefits:
                            <ol>
                                <li>JSON friendly persisted models.</li>
                                <li>Having frictionless system interoperability with Ruby and NodeJS and any JSON friendly object oriented app.</li>
                                <li>Dealing with Gigas or Teras order of magnitude databases.</li>
                                <li>High availability via <a href="https://www.mongodb.com/docs/manual/replication/" target="_bank">MongoDB Replica Set features</a> or <a href="https://www.postgresql.org/docs/current/high-availability.html" target="_bank">PostgreSQL Replication</a>.</li>
                                <li>Replication of the whole database across the cloud.</li>
                                <li>World class databases many engineers are familiar to use and <em>maintain</em>.</li>
                                <li>Powerful queries and custom indices.</li>
                                <li>Freedom from <em>a prioristic</em> instVars declarations.</li>
                                <li>Freedom from mappings maintenance <em>when</em> the design changes.</li>                                
                                <li>Cross-image model caching (requires Redis).</li>
                                <li>Cross-image model observation/reaction, horizontally scalling the <a href="http://en.wikipedia.org/wiki/Observer_pattern" >Observer Pattern</a> (requires Redis PUB/SUB).</li>
                            </ol> All that with <em>very low-friction and low-maintenance</em> using one comfortable API.<p>                    
                    </div>
                </div>

                <div id="direction" class="col-md-12 ">
                    <div class="elaborate">
                        <h5>Found a Bug?</h5>
                        <h5>Need that feature for your use case?</h5>
                        <p>Please create a <a href="https://github.com/sebastianconcept/Mapless/issues" target="_blank">GitHub issue</a> in the Mapless repository.</p>
                    </div>
                </div>

                 <div id="direction" class="col-md-12 ">
                    <div class="elaborate">
                        <h5>Need additional support?</h5>
                        <p>Don't hesitate to reach out in <a href="https://twitter.com/sebastianconcpt" target="_blank">𝕏</a> or <a href="https://www.linkedin.com/in/sebastiansastre/" target="_blank">LinkedIn</a> <a href="https://discord.com/invite/QewZMZa" target="_blank">Pharo Discord server</a> for discussing design possibilities and implementation support.</p>
                    </div>
                </div>

                 <div class="col-md-12">
                    <div class="elaborate ">
                        <h5 class="">License</h5>
                        <p>Since 2014 <a href="http://sebastiansastre.co">Sebastian Sastre</a> published Mapless under the terms of <a href="https://github.com/sebastianconcept/Mapless/blob/master/LICENSE">MIT License</a>.</p>
                </div>
        </section>
</div>
<div>
    {% include foot.html %}
</div>